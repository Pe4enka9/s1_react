import{b as _,i as j,a as v,c as h,d as U,r as i,j as c,D as Z,e as ee}from"./date-DgmWt_b0.js";import{c as te}from"./calendar-C1cdyjD9.js";import{S as k,I as w,P as ne,B as ae}from"./BaseForm-Iqju4LCa.js";import{a as re}from"./forms-Bcu1OiOT.js";import{g as P}from"./getFirstError-BclANIRF.js";import"./vendor-gH-7aFTg.js";function b(e,t){if(e.one!==void 0&&t===1)return e.one;const r=t%10,n=t%100;return r===1&&n!==11?e.singularNominative.replace("{{count}}",String(t)):r>=2&&r<=4&&(n<10||n>20)?e.singularGenitive.replace("{{count}}",String(t)):e.pluralGenitive.replace("{{count}}",String(t))}function s(e){return(t,r)=>r?.addSuffix?r.comparison&&r.comparison>0?e.future?b(e.future,t):"через "+b(e.regular,t):e.past?b(e.past,t):b(e.regular,t)+" назад":b(e.regular,t)}const ie={lessThanXSeconds:s({regular:{one:"меньше секунды",singularNominative:"меньше {{count}} секунды",singularGenitive:"меньше {{count}} секунд",pluralGenitive:"меньше {{count}} секунд"},future:{one:"меньше, чем через секунду",singularNominative:"меньше, чем через {{count}} секунду",singularGenitive:"меньше, чем через {{count}} секунды",pluralGenitive:"меньше, чем через {{count}} секунд"}}),xSeconds:s({regular:{singularNominative:"{{count}} секунда",singularGenitive:"{{count}} секунды",pluralGenitive:"{{count}} секунд"},past:{singularNominative:"{{count}} секунду назад",singularGenitive:"{{count}} секунды назад",pluralGenitive:"{{count}} секунд назад"},future:{singularNominative:"через {{count}} секунду",singularGenitive:"через {{count}} секунды",pluralGenitive:"через {{count}} секунд"}}),halfAMinute:(e,t)=>t?.addSuffix?t.comparison&&t.comparison>0?"через полминуты":"полминуты назад":"полминуты",lessThanXMinutes:s({regular:{one:"меньше минуты",singularNominative:"меньше {{count}} минуты",singularGenitive:"меньше {{count}} минут",pluralGenitive:"меньше {{count}} минут"},future:{one:"меньше, чем через минуту",singularNominative:"меньше, чем через {{count}} минуту",singularGenitive:"меньше, чем через {{count}} минуты",pluralGenitive:"меньше, чем через {{count}} минут"}}),xMinutes:s({regular:{singularNominative:"{{count}} минута",singularGenitive:"{{count}} минуты",pluralGenitive:"{{count}} минут"},past:{singularNominative:"{{count}} минуту назад",singularGenitive:"{{count}} минуты назад",pluralGenitive:"{{count}} минут назад"},future:{singularNominative:"через {{count}} минуту",singularGenitive:"через {{count}} минуты",pluralGenitive:"через {{count}} минут"}}),aboutXHours:s({regular:{singularNominative:"около {{count}} часа",singularGenitive:"около {{count}} часов",pluralGenitive:"около {{count}} часов"},future:{singularNominative:"приблизительно через {{count}} час",singularGenitive:"приблизительно через {{count}} часа",pluralGenitive:"приблизительно через {{count}} часов"}}),xHours:s({regular:{singularNominative:"{{count}} час",singularGenitive:"{{count}} часа",pluralGenitive:"{{count}} часов"}}),xDays:s({regular:{singularNominative:"{{count}} день",singularGenitive:"{{count}} дня",pluralGenitive:"{{count}} дней"}}),aboutXWeeks:s({regular:{singularNominative:"около {{count}} недели",singularGenitive:"около {{count}} недель",pluralGenitive:"около {{count}} недель"},future:{singularNominative:"приблизительно через {{count}} неделю",singularGenitive:"приблизительно через {{count}} недели",pluralGenitive:"приблизительно через {{count}} недель"}}),xWeeks:s({regular:{singularNominative:"{{count}} неделя",singularGenitive:"{{count}} недели",pluralGenitive:"{{count}} недель"}}),aboutXMonths:s({regular:{singularNominative:"около {{count}} месяца",singularGenitive:"около {{count}} месяцев",pluralGenitive:"около {{count}} месяцев"},future:{singularNominative:"приблизительно через {{count}} месяц",singularGenitive:"приблизительно через {{count}} месяца",pluralGenitive:"приблизительно через {{count}} месяцев"}}),xMonths:s({regular:{singularNominative:"{{count}} месяц",singularGenitive:"{{count}} месяца",pluralGenitive:"{{count}} месяцев"}}),aboutXYears:s({regular:{singularNominative:"около {{count}} года",singularGenitive:"около {{count}} лет",pluralGenitive:"около {{count}} лет"},future:{singularNominative:"приблизительно через {{count}} год",singularGenitive:"приблизительно через {{count}} года",pluralGenitive:"приблизительно через {{count}} лет"}}),xYears:s({regular:{singularNominative:"{{count}} год",singularGenitive:"{{count}} года",pluralGenitive:"{{count}} лет"}}),overXYears:s({regular:{singularNominative:"больше {{count}} года",singularGenitive:"больше {{count}} лет",pluralGenitive:"больше {{count}} лет"},future:{singularNominative:"больше, чем через {{count}} год",singularGenitive:"больше, чем через {{count}} года",pluralGenitive:"больше, чем через {{count}} лет"}}),almostXYears:s({regular:{singularNominative:"почти {{count}} год",singularGenitive:"почти {{count}} года",pluralGenitive:"почти {{count}} лет"},future:{singularNominative:"почти через {{count}} год",singularGenitive:"почти через {{count}} года",pluralGenitive:"почти через {{count}} лет"}})},ue=(e,t,r)=>ie[e](t,r),oe={full:"EEEE, d MMMM y 'г.'",long:"d MMMM y 'г.'",medium:"d MMM y 'г.'",short:"dd.MM.y"},se={full:"H:mm:ss zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},le={any:"{{date}}, {{time}}"},ce={date:_({formats:oe,defaultWidth:"full"}),time:_({formats:se,defaultWidth:"full"}),dateTime:_({formats:le,defaultWidth:"any"})},D=["воскресенье","понедельник","вторник","среду","четверг","пятницу","субботу"];function de(e){const t=D[e];switch(e){case 0:return"'в прошлое "+t+" в' p";case 1:case 2:case 4:return"'в прошлый "+t+" в' p";case 3:case 5:case 6:return"'в прошлую "+t+" в' p"}}function I(e){const t=D[e];return e===2?"'во "+t+" в' p":"'в "+t+" в' p"}function me(e){const t=D[e];switch(e){case 0:return"'в следующее "+t+" в' p";case 1:case 2:case 4:return"'в следующий "+t+" в' p";case 3:case 5:case 6:return"'в следующую "+t+" в' p"}}const fe={lastWeek:(e,t,r)=>{const n=e.getDay();return j(e,t,r)?I(n):de(n)},yesterday:"'вчера в' p",today:"'сегодня в' p",tomorrow:"'завтра в' p",nextWeek:(e,t,r)=>{const n=e.getDay();return j(e,t,r)?I(n):me(n)},other:"P"},pe=(e,t,r,n)=>{const l=fe[e];return typeof l=="function"?l(t,r,n):l},ge={narrow:["до н.э.","н.э."],abbreviated:["до н. э.","н. э."],wide:["до нашей эры","нашей эры"]},ve={narrow:["1","2","3","4"],abbreviated:["1-й кв.","2-й кв.","3-й кв.","4-й кв."],wide:["1-й квартал","2-й квартал","3-й квартал","4-й квартал"]},he={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],wide:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"]},be={narrow:["Я","Ф","М","А","М","И","И","А","С","О","Н","Д"],abbreviated:["янв.","фев.","мар.","апр.","мая","июн.","июл.","авг.","сент.","окт.","нояб.","дек."],wide:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"]},ye={narrow:["В","П","В","С","Ч","П","С"],short:["вс","пн","вт","ср","чт","пт","сб"],abbreviated:["вск","пнд","втр","срд","чтв","птн","суб"],wide:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"]},Ge={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утро",afternoon:"день",evening:"веч.",night:"ночь"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утро",afternoon:"день",evening:"вечер",night:"ночь"}},we={narrow:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},abbreviated:{am:"ДП",pm:"ПП",midnight:"полн.",noon:"полд.",morning:"утра",afternoon:"дня",evening:"веч.",night:"ночи"},wide:{am:"ДП",pm:"ПП",midnight:"полночь",noon:"полдень",morning:"утра",afternoon:"дня",evening:"вечера",night:"ночи"}},Pe=(e,t)=>{const r=Number(e),n=t?.unit;let l;return n==="date"?l="-е":n==="week"||n==="minute"||n==="second"?l="-я":l="-й",r+l},Ne={ordinalNumber:Pe,era:v({values:ge,defaultWidth:"wide"}),quarter:v({values:ve,defaultWidth:"wide",argumentCallback:e=>e-1}),month:v({values:he,defaultWidth:"wide",formattingValues:be,defaultFormattingWidth:"wide"}),day:v({values:ye,defaultWidth:"wide"}),dayPeriod:v({values:Ge,defaultWidth:"any",formattingValues:we,defaultFormattingWidth:"wide"})},Se=/^(\d+)(-?(е|я|й|ое|ье|ая|ья|ый|ой|ий|ый))?/i,Me=/\d+/i,xe={narrow:/^((до )?н\.?\s?э\.?)/i,abbreviated:/^((до )?н\.?\s?э\.?)/i,wide:/^(до нашей эры|нашей эры|наша эра)/i},We={any:[/^д/i,/^н/i]},_e={narrow:/^[1234]/i,abbreviated:/^[1234](-?[ыои]?й?)? кв.?/i,wide:/^[1234](-?[ыои]?й?)? квартал/i},ke={any:[/1/i,/2/i,/3/i,/4/i]},De={narrow:/^[яфмаисонд]/i,abbreviated:/^(янв|фев|март?|апр|ма[йя]|июн[ья]?|июл[ья]?|авг|сент?|окт|нояб?|дек)\.?/i,wide:/^(январ[ья]|феврал[ья]|марта?|апрел[ья]|ма[йя]|июн[ья]|июл[ья]|августа?|сентябр[ья]|октябр[ья]|октябр[ья]|ноябр[ья]|декабр[ья])/i},Te={narrow:[/^я/i,/^ф/i,/^м/i,/^а/i,/^м/i,/^и/i,/^и/i,/^а/i,/^с/i,/^о/i,/^н/i,/^я/i],any:[/^я/i,/^ф/i,/^мар/i,/^ап/i,/^ма[йя]/i,/^июн/i,/^июл/i,/^ав/i,/^с/i,/^о/i,/^н/i,/^д/i]},Ce={narrow:/^[впсч]/i,short:/^(вс|во|пн|по|вт|ср|чт|че|пт|пя|сб|су)\.?/i,abbreviated:/^(вск|вос|пнд|пон|втр|вто|срд|сре|чтв|чет|птн|пят|суб).?/i,wide:/^(воскресень[ея]|понедельника?|вторника?|сред[аы]|четверга?|пятниц[аы]|суббот[аы])/i},Fe={narrow:[/^в/i,/^п/i,/^в/i,/^с/i,/^ч/i,/^п/i,/^с/i],any:[/^в[ос]/i,/^п[он]/i,/^в/i,/^ср/i,/^ч/i,/^п[ят]/i,/^с[уб]/i]},Re={narrow:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,abbreviated:/^([дп]п|полн\.?|полд\.?|утр[оа]|день|дня|веч\.?|ноч[ьи])/i,wide:/^([дп]п|полночь|полдень|утр[оа]|день|дня|вечера?|ноч[ьи])/i},Ee={any:{am:/^дп/i,pm:/^пп/i,midnight:/^полн/i,noon:/^полд/i,morning:/^у/i,afternoon:/^д[ен]/i,evening:/^в/i,night:/^н/i}},je={ordinalNumber:U({matchPattern:Se,parsePattern:Me,valueCallback:e=>parseInt(e,10)}),era:h({matchPatterns:xe,defaultMatchWidth:"wide",parsePatterns:We,defaultParseWidth:"any"}),quarter:h({matchPatterns:_e,defaultMatchWidth:"wide",parsePatterns:ke,defaultParseWidth:"any",valueCallback:e=>e+1}),month:h({matchPatterns:De,defaultMatchWidth:"wide",parsePatterns:Te,defaultParseWidth:"any"}),day:h({matchPatterns:Ce,defaultMatchWidth:"wide",parsePatterns:Fe,defaultParseWidth:"any"}),dayPeriod:h({matchPatterns:Re,defaultMatchWidth:"wide",parsePatterns:Ee,defaultParseWidth:"any"})},Ie={code:"ru",formatDistance:ue,formatLong:ce,formatRelative:pe,localize:Ne,match:je,options:{weekStartsOn:1,firstWeekContainsDate:1}};ee("ru",Ie);function Ye({isActive:e,setIsActive:t,setNotification:r}){const[n,l]=i.useState({phone_number:"",date:"",duration:"",number_of_people:""}),[d,y]=i.useState({}),[u,f]=i.useState(0),[L,z]=i.useState(!0),[H,T]=i.useState(!1),[V,N]=i.useState(!1),[X,p]=i.useState(null),[O,g]=i.useState("next"),[Y,C]=i.useState(!1),[S,F]=i.useState(!1),R=i.useRef(null),E=i.useRef(null),G=i.useRef(null),M=i.useRef(null),x=i.useRef(null),W=i.useCallback(a=>{const{name:o,value:m}=a.target;l({...n,[o]:m}),y({...d,[o]:""})},[d,n]),$=i.useCallback(()=>{let a=!1;return u===1?a=n.phone_number.length<18:u===2?a=!n.date.trim()||!n.duration.trim():u===3&&(a=!n.number_of_people.trim()),a},[u,n.date,n.duration,n.number_of_people,n.phone_number.length]),B=i.useCallback(async()=>{try{G.current?.blur(),T(!0),y({}),N(!1),(await re.post("http://127.0.0.1:8000/api/booking",n)).status===201&&(r({text:"Вы записаны!",failed:!1,active:!0}),setTimeout(()=>r(o=>({...o,active:!1})),2e3),C(!1),M.current=setTimeout(()=>{f(0),l({phone_number:"",date:"",duration:"",number_of_people:""}),t(!1)},1200))}catch(a){r({text:"Не удалось забронировать",failed:!0,active:!0}),setTimeout(()=>r(m=>({...m,active:!1})),2e3),a.code==="ERR_NETWORK"&&(N(!0),x.current=setTimeout(()=>N(!1),2e3));const o=a.response.data.errors;y(o),o.number_of_people&&u!==3?(p(u),g("next"),f(3),setTimeout(()=>G.current?.focus(),800)):o.date&&u!==2?(p(u),g("prev"),f(2)):o.duration&&u!==2?(p(u),g("prev"),f(2),setTimeout(()=>E.current?.focus(),800)):o.phone_number&&u!==1&&(p(u),g("prev"),f(1),setTimeout(()=>R.current?.focus(),800))}finally{T(!1)}},[u,n,t,r]),q=i.useMemo(()=>[c.jsx(k,{children:c.jsx(w,{id:"phone_number",label:"Номер телефона",error:P(d.phone_number),children:c.jsx(ne,{formData:n,setFormData:l,errors:d,setErrors:y,inputRef:R})})},"step-1"),c.jsxs(k,{children:[c.jsx(w,{id:"date",label:"Дата",error:P(d.date),children:c.jsx(Z,{name:"date",id:"date",className:d.date?"error-input":"",showMonthYearDropdown:!1,showTimeSelect:!0,selected:n.date?new Date(n.date):null,minDate:new Date,onChange:a=>{const o=a.getFullYear(),m=String(a.getMonth()+1).padStart(2,"0"),A=String(a.getDate()).padStart(2,"0"),K=String(a.getHours()).padStart(2,"0"),Q=String(a.getMinutes()).padStart(2,"0"),J=`${o}-${m}-${A}T${K}:${Q}:00`;l({...n,date:J})},onCalendarOpen:()=>{setTimeout(()=>F(!0),100)},onCalendarClose:()=>{setTimeout(()=>F(!1),500)},placeholderText:"Введите дату",dateFormat:"dd MMMM yyyy, HH:mm",locale:"ru",withPortal:!0,portalId:"calendar",calendarClassName:`calendar ${S?"active":""}`,portalClassName:"portal",onFocus:a=>a.target.readOnly=!0,dayClassName:a=>{const o=a.getDay();let m="calendar-day";return(o===0||o===6)&&(m+=" weekend"),m},timeIntervals:60,timeCaption:"Время",timeClassName:()=>"time-item"})}),c.jsx(w,{id:"duration",label:"Продолжительность",error:P(d.duration),children:c.jsx("input",{type:"number",name:"duration",id:"duration",className:d.duration?"error-input":"",placeholder:"2 часа",value:n.duration,onChange:W,ref:E})})]},"step-2"),c.jsx(k,{children:c.jsx(w,{id:"number_of_people",label:"Количество человек",error:P(d.number_of_people),children:c.jsx("input",{type:"number",inputMode:"numeric",name:"number_of_people",id:"number_of_people",className:d.number_of_people?"error-input":"",placeholder:"Максимум 5",value:n.number_of_people,onChange:W,enterKeyHint:"done",ref:G})})},"step-3")],[d,n,W,S]);return i.useEffect(()=>()=>{M.current&&clearTimeout(M.current),x.current&&clearTimeout(x.current)},[]),i.useEffect(()=>{let a=null;return u===3&&(a=setTimeout(()=>G.current?.focus(),800)),()=>{a&&clearTimeout(a)}},[u]),c.jsx(ae,{isActive:e,setIsActive:t,currentStep:u,setCurrentStep:f,steps:q,isDisabledButton:L,setIsDisabledButton:z,isServerError:V,isLoading:H,direction:O,setDirection:g,prevStep:X,setPrevStep:p,isAnimating:Y,setIsAnimating:C,id:"booking",failedValidation:$,icon:c.jsx("img",{src:te,alt:"Бронирование",loading:"lazy"}),title:"Бронирование",buttonText:"Забронировать",progressLabels:["Контакт","Дата и время","Люди"],onSubmit:B,isCalendar:!0,isCalendarActive:S})}export{Ye as default};
